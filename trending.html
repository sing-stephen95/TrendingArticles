<?xml version="1.0" encoding="UTF-8">
<!DOCTYPE html trending SYSTEM "trending.dtd">
<html>
<head>
	<title> Trending News </title>
	<link rel = "stylesheet" type="text/css" href="style.css"/>
	<script type="text/javascript">
		function check(){
                var loc = window.location.href;
				
				//Check if proxy_format field exists
				if(loc.indexOf('proxy_format') >= 0){
					//Extract the query string
					var qString = loc.split('?');
					
					//Separate fields from query string
					var qFields = qString[1].split('&');
					
					//Get value of proxy_format. RSS or JSON
					if(qFields.indexOf('proxy_format') >= 0){
						var i = qFields.indexOf('proxy_format');
						var pfField= qFields[i].split('=');
						var proxy_format = pfField[1];
					}
				}
				else{
					var proxy_format = 'rss';
				}

                Request(proxy_format);
				
                setTimeout(check, 30000);
            
		}
		function Request(proxy_format){
			if(window.XMLHttpRequest)
			{
				xmlhttp = new XMLHttpRequest();
			}
			else
			{
				xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
			}

			xmlhttp.onreadystatechange = function()
			{
				if(xmlhttp.readyState == 4 && xmlhttp.status == 200)
				{
					 if(proxy_format=="json"){
					 }
					 else if(proxy_format=="rss"){
					 
						//alert(xmlhttp.responseText);
						document.getElementById("news").innerHTML = xmlhttp.responseText;
						//parseRSS(xmlhttp.responseText);
					 }
                     
				}
			}
			
			xmlhttp.open("GET", "proxy.php" + "?f=" + proxy_format + "&q=" + enter.value + "&num=100", true); 
			
			xmlhttp.send();
		}
		
		/*function parseRSS(xml){
			var items = xml.replace(/<\/item>/, "</item>\n\n");
			//items = items.replace(/<\/title>/, "</title>\n);
			
			var parser = new DOMParser();
			var xmlDoc = parser.parseFromString(xml, "text/xml");
			txt = "";
			x = xmlDoc.getElementsByTagName("item");
			for (i = 0; i < x.length; i++) {
			  txt += x[i].childNodes[0].nodeValue + "<br>";
			  }

			document.getElementById("news").innerHTML = items;
		}*/
  	 </script>
</head>

<body onload="check()">
	<div id = "container">
		<div id = "header">
		  	<h1> Trending News </h1>
		  	<form>
		  		<label for "KeywordFilter">Keyword Filter:</label>
		  		<input id = "enter" type ="text" name="enter"> 
		  		<!--button id = "submit">Submit</button-->
		</div>

		<div id = "content">
			<ul>
				<li> trend 1  </li>
				<li> trend 2  </li>
				<li> trend 3  </li>
				<li> trend 4  </li>
				<li> trend 5  </li>
				<li> trend 6  </li>
				<li> trend 7  </li>
				<li> trend 8  </li>
				<li> trend 9  </li>
				<li> trend 10 </li>
			</ul>
	 	</div>
	 </div>

	 <div id="newss">
     <!--h2 id="newsLink"><a href="http://yioop.com/s/news">News</a></h2--> 
     </div>
	 <textarea readonly rows="100" cols="160" id='news'></textarea>


</body>
</html>
